<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sts.dao.ProductMapper" >
  <resultMap id="BaseResultMap" type="com.sts.pojo.Product" >
    <id column="good_id" property="goodId" jdbcType="INTEGER" />
    <result column="good_name" property="goodName" jdbcType="VARCHAR" />
    <result column="good_num" property="goodNum" jdbcType="INTEGER" />
    <result column="good_price" property="goodPrice" jdbcType="DOUBLE" />
    <result column="good_describe" property="goodDescribe" jdbcType="VARCHAR" />
    <result column="good_image" property="goodImage" jdbcType="VARCHAR" />
    <result column="good_time" property="goodTime" jdbcType="TIMESTAMP" />
    <result column="good_click" property="goodClick" jdbcType="INTEGER" />
    <result column="good_status" property="goodStatus" jdbcType="INTEGER" />
    <result column="user_id" property="userId" jdbcType="INTEGER" />
    <result column="category_id" property="categoryId" jdbcType="INTEGER" />
  </resultMap>
  
  <sql id="baseColumn">
  		good_id, good_name, good_num, good_price, good_describe, good_image, good_time, good_click, 
    	good_status, user_id, category_id
  </sql>
  
  <select id="queryListByTime" resultMap="BaseResultMap">
  	select 
  		<include refid="baseColumn"/>
  	from product a 
  	where a.good_status = 1
  	order by a.good_time desc
  </select>
  
  <select id="queryListByCid" parameterType="java.lang.String" resultMap="BaseResultMap" >
  	select 
  		<include refid="baseColumn"/>
  	from product a 
  	where a.category_id = #{cid} 
  		and a.good_status = 1
  	order by a.good_click desc
  </select>
  
   <select id="queryListByName" parameterType="java.lang.String"  resultMap="BaseResultMap">
  	select 
  		<include refid="baseColumn"/>
  	from product a where a.good_name like concat('%', #{goodName}, '%') 
  	and a.good_status = 1
  	order by a.good_click desc
   </select>
   
   <select id="queryByGoodId" parameterType="java.lang.String"  resultMap="BaseResultMap">
   	select 
   		<include refid="baseColumn"/>
   	from product a where a.good_id = #{goodId}
   </select>
  
  <select id="queryByUserId" parameterType="java.lang.Integer" resultMap="BaseResultMap">
  	SELECT
		p.good_name,
		p.good_price,
		p.good_image,
		p.good_status
	FROM
		shopcart sc
	JOIN product p ON p.good_id = sc.good_id
	where sc.user_id = #{userId}
  </select>
  
  <update id="updateGoodStatus" parameterType="Product">
  	update product a 
  		set a.good_status = #{goodStatus}
  	where 
  		a.good_id = #{goodId}
  </update>
</mapper>